#!/usr/bin/env ruby
require 'highline'

strip_word = ARGV.first
context_color = 'CYAN'
project_color = 'RED'

while STDIN.gets
  s = ($_ || '')

  if strip_word 
    strip_word_re = /#{Regexp.escape(strip_word)} */
    next unless s =~ strip_word_re 
    s.gsub!(strip_word_re, '') 
  end

  t = HighLine.new(STDIN, STDOUT)
  # color @contexts and +projects
  s.gsub!(/@\S+/) {|m|
    "<%= color '#{m}', #{context_color} %>"
  }
  s.gsub!(/\+\S+/) {|m|
    "<%= color '#{m}', #{project_color} %>"
  }

  t.say s
end
